## Make Building C as Simple as Pie

Mekpie is an opinionated build system for small scale C projects. The core premise of Mekpie is that you should not be spending time worrying about Make files, compiler arguments, or build times, when working on a small C projects. By enforcing a simple directory structure and always providing a clean build, Mekpie saves you time and effort. For added convenience Mekpie takes notes from tools like [Rust's cargo](https://doc.rust-lang.org/cargo/guide/index.html) and [Node's npm](https://www.npmjs.com/) and provides options for building, running, cleaning, and testing your current project.

Mekpie is a small scale project and is not supposed to replace tools like [CMake](https://cmake.org/) or provide any sort of package management capabilities. Use Mekpie when the alternative is a shoddy Make file or manually compiling.

### Installing

*Coming soon*

Mekpie is a python package. Use pip to install it!
```bash
$ pip install mekpie
```

### Getting Started

Create a new project by running
```bash
$ mekpie new "project-name"
project-name created succesfully!
```

Then navigate to the project directory and run
```bash
$ mekpie run
Project succesfully cleaned.
Project succesfully built.
Hello, World!
```

That's it!

### Philosophy

History as a python script. Clean builds. No incremental builds. Small projects, running my Make file or python script took as long as compiling. Dislike IDEs for small projects.

### Creating a Project

Mekpie provides two commands for creating a project. `mekpie new` will attempt to create a new project as a subdirectory of your current location. You will have to provide Mekpie a name for your project. This name will be used as the name for the directory as well as the main `.c` file (don't worry you can change that later).

Alternatively, you can use the `mekpie init` command to create a new project. In this case Mekpie will use the name of the current directory as the project name and setup the project in your current location. 

### Project Structure

When you create a project using either `new` or `init` the following directory structure will be generated.
```txt
project/
    target/
    includes/
    src/
        project-name.c
    tests/
    mek.py
```

The first folder generated by Mekpie, `target/`, is used to store the debug and release binaries generated for your program.

The `includes/` folder is automatically included as an includes directory to your compiler, so you can place any header files you want included in this directory. You can also place subdirectories within `includes/`.

The `src/` folder should contain all your `.c` files. Like `includes/` you can use subdirectories within. By default a main file will be generated by Mekpie with a simple Hello World program to heelp you ensure everything is working correctly.

The `tests/` folder should contain all your test files. Jump [here](#testing) to find out more about tests.

The final file created by Mekpie is `mek.py` which is a small python file that allows you to configure Mekpie.

### Configuration

Configuration of Mekpie is done through the python file `mek.py` in the root of your project directory. Mekpie will autogenerate a file like the following when you first create a project.

```python
# This is a standard configuration file for mekpie

name = 'test' 
main = 'test.c'
libs = []
cc = 'gcc/clang'
cmd = 'clang'
dbg = 'lldb'
flags = ['-Wall']
override_debug_flags = None
override_release_flags = None

if options.release:
    pass # this code will only run for release builds
else:
    pass # this code will only run for debug builds
```

As shown at the bottom of the configuration file, the command line options for the current build command will be provided to your configuration anytime it is read. This allows you to easily change your configuration depending on the build. In addition to release, the options object also provides `options.quiet`, `options.verbose`, and `options.developer` which correspond to their respective command line flags.

The following table describes each option in detail.

| Option | Default | Description |
|--------|---------|-------------|
| `name` | `<projectname>` | This is a default identifier for your project. |
| `main` | `<projectname>.c` | This should be the entry point for your main program. By default it will point at the c file auto-generated by Mekpie. |
| `libs` | `[]` | Add any libraries you want linked with your project here. For instance, if you wanted to include the c math library you would change libs to `['m']`. |
| `cc` | `'gcc/clang'` | The c compiler configuration. Currently the only supported compiler is gcc and clang. In the future we may support more configurations.
|`cmd` | *auto-detected* | The command on the command line that corresponds to your c compiler. By default mekpie will try to auto-detect this. |
| `dbg` | *auto-detected* | The command on the command line used to start your desired debugger. By default mekpie will try to auto-detect this. |
| `flags` | `[]` | These flags will be passed to the compiler whenever a file is compiled. For instance, to always produce verbose output from the compiler, flags could be changed to `[-v]`. |
| `override_debug_flags` | `None` | If this option is replaced with a list of strings, it will replace the c compiler configuration's choice of flags for debug builds. |
| `override_release_flags` | `None` | If this option is replaced with a list of strings, it will replace the c compiler configuration's choice of flags for release builds. |

### Testing

### Commands

#### `new`

#### `init`

#### `test`

#### `clean`

#### `build`

#### `run`

#### `debug`

### Contact

Feel free to send be bug reports or feature requests. If you are interested in my other work, checkout my [website](https://ejrbuss.net).

Email ejrbuss@gmail.com